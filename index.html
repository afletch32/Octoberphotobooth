<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Event Photobooth</title>
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" sizes="180x180" href="appicon.png">
  <link rel="icon" type="image/png" sizes="192x192" href="appicon.png">
  <link rel="icon" type="image/png" sizes="512x512" href="appicon.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#0f1222">
  <link rel="stylesheet" href="fonts.css">
  <style>
    :root {
      --accent: rgb(212, 242, 217);
      --accent2: white;
      --font-heading: 'Comic Neue', cursive;
      --font-body: 'Comic Neue', cursive;
      --font: var(--font-body);
      --countdown-font: 'Creepster', cursive;
      --event-title-size: 1.8em;
      --welcome-title-size: 3.4em;
    }    
    body,
    html {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: var(--font-body, var(--font, 'Comic Neue', cursive));
      background: #000;
      color: white;
      overflow: hidden;
    }

    .hidden {
      display: none !important;
    }

    .visually-hidden {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    button {
      margin: 6px;
      padding: 10px 18px;
      border: none;
      border-radius: 8px;
      font-size: 1.05em;
      cursor: pointer;
      background: #1f1f1f;
      color: #fff;
    }

    button.primary {
      background: var(--accent);
      color: #000;
      font-weight: 700;
    }

    button .btn-icon {
      display: inline-block;
      margin-right: 6px;
      font-size: 1.1em;
      line-height: 1;
    }

    /* App-icon style tiles */
    .icon-tiles {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
    }

    .icon-tile {
      display: inline-flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      width: 84px;
      height: 84px;
      border-radius: 20px;
      border: 6px solid #fff;
      outline: 5px solid #222;
      background: radial-gradient(120% 120% at 35% 30%, #d8cbf6 0%, #dd7aec 35%, #7740b5 70%, #492d6b 100%);
      box-shadow: 0 16px 40px rgba(0, 0, 0, .55), inset 0 2px 10px rgba(255, 255, 255, .45);
      color: #000;
      cursor: pointer;
      transition: transform .12s ease, box-shadow .2s ease;
    }

    .icon-tile:hover {
      transform: translateY(-2px);
    }

    .icon-tile:active {
      transform: translateY(0);
    }

    .icon-glyph {
      font-size: 34px;
      line-height: 1;
    }

    .icon-label {
      margin-top: 6px;
      font: 700 12px 'Bangers', cursive;
      letter-spacing: .5px;
      color: #000;
    }

    #adminScreen {
      padding: 32px 20px;
      text-align: center;
      position: relative;
      z-index: 100;
      background: #000;
      height: 100vh;
      overflow: auto;
      -webkit-overflow-scrolling: touch;
    }

    .admin-title {
      font-size: 2.2em;
      margin: 6px 0 18px;
      letter-spacing: .5px;
      background: linear-gradient(90deg, var(--accent), #fff);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      font-family: var(--font-heading, 'Comic Neue', cursive);
    }

    .admin-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      max-width: 1200px;
      margin: 0 auto;
      align-items: start;
    }

    .panel {
      background: #0c0c0f;
      border: 1px solid #1f1f1f;
      border-radius: 14px;
      padding: 16px 18px;
      text-align: left;
      box-shadow: 0 10px 28px rgba(0, 0, 0, .35);
      position: relative;
    }

    .panel h2 {
      margin: 0 0 10px;
      font-size: 1.4em;
      color: var(--accent2);
      font-family: var(--font-heading, 'Comic Neue', cursive);
    }

    .panel h3 {
      margin: 10px 0 6px;
      font-size: 1.05em;
      color: #ddd;
      font-family: var(--font-heading, 'Comic Neue', cursive);
    }

    details.panel-section {
      background: #0b0d12;
      border: 1px solid #1c1f29;
      border-radius: 12px;
      padding: 14px 16px;
      margin-top: 12px;
    }

    details.panel-section:first-of-type {
      margin-top: 0;
    }

    details.panel-section>summary {
      list-style: none;
      cursor: pointer;
      font-weight: 600;
      color: var(--accent2);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      font-size: 1.05em;
    }

    details.panel-section>summary::-webkit-details-marker {
      display: none;
    }

    details.panel-section>summary::after {
      content: '+';
      font-weight: 400;
      color: #888;
      transition: transform .2s ease;
    }

    details.panel-section[open]>summary::after {
      content: 'âˆ’';
      color: #bbb;
    }

    details.panel-section .section-content {
      margin-top: 12px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .theme-editor-summary {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      align-items: center;
      justify-content: space-between;
      padding: 12px 14px;
      border: 1px solid #1c1f29;
      border-radius: 12px;
      background: #0b0d12;
      margin-bottom: 14px;
    }

    .theme-editor-current {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .theme-editor-current-label {
      font-size: .85em;
      color: #aab;
      text-transform: uppercase;
      letter-spacing: .08em;
    }

    .theme-editor-current-name {
      font-weight: 600;
      color: var(--accent2);
      font-size: 1.05em;
    }

    .theme-editor-current-sub {
      font-size: .9em;
      color: #9aa;
    }

    .theme-editor-action {
      display: flex;
      flex-direction: column;
      gap: 6px;
      align-items: flex-start;
    }

    .theme-editor-action label {
      font-size: .85em;
      color: #aab;
      text-transform: uppercase;
      letter-spacing: .06em;
    }

    .theme-editor-action select {
      padding: 6px 10px;
      border-radius: 6px;
      border: 1px solid #2d3242;
      background: #101420;
      color: #f5f7fb;
    }

    .theme-editor-section {
      margin: 16px 0;
    }

    .theme-editor-section.hidden {
      display: none;
    }

    .theme-editor-group {
      display: grid;
      gap: 12px;
      margin-bottom: 16px;
    }

    .theme-field {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    #adminScreen label {
      display: block;
      margin: 10px 0 6px;
      color: #ddd;
    }

    #adminScreen input[type="text"],
    #adminScreen input[type="email"],
    #adminScreen input[type="color"],
    #adminScreen select {
      width: 100%;
      box-sizing: border-box;
      background: #101217;
      color: #eee;
      border: 1px solid #2b2f3a;
      border-radius: 10px;
      padding: 10px 12px;
      font-size: 1em;
      outline: none;
    }

    #adminScreen input[type="file"] {
      display: block;
      width: 100%;
      color: #ccc;
    }

    #adminScreen .btn-row {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin: 10px 0 6px;
    }

    #adminScreen .btn-row button {
      flex: 1 1 auto;
    }

    #analytics {
      background: #0c0c0f;
      border: 1px solid #1f1f1f;
      border-radius: 12px;
      padding: 12px;
    }

    #analytics h2 {
      margin-top: 0;
    }

    @media (max-width: 900px) {
      .admin-container {
        grid-template-columns: 1fr;
      }
    }

    /* Theme asset previews */
    .current-assets {
      margin-top: 12px;
    }

    .asset-row {
      margin: 10px 0;
    }

    .asset-actions {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 10px;
    }

    .asset-actions button {
      padding: 6px 12px;
      border-radius: 6px;
      border: 1px solid #2d3242;
      background: #1a2133;
      color: #fff;
      cursor: pointer;
      font-size: 0.9em;
    }

    .asset-actions button:hover {
      background: #243049;
    }

    .asset-row>label {
      display: block;
      margin-bottom: 6px;
      color: #bbb;
    }

    .asset-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: flex-start;
    }

    .asset-single {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    #currentFont.asset-single {
      align-items: stretch;
      flex-direction: column;
    }

    .asset-item {
      background: #0f1116;
      border: 1px solid #232734;
      border-radius: 8px;
      padding: 6px;
    }

    .asset-item.selected {
      border-color: var(--accent);
      box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.05) inset;
    }

    .asset-item img {
      display: block;
      width: 100px;
      height: auto;
      border-radius: 6px;
    }

    .asset-badge {
      display: inline-block;
      margin-top: 4px;
      font-size: .8em;
      color: #aaa;
    }

    .asset-item {
      position: relative;
    }

    .asset-remove {
      position: absolute;
      top: 4px;
      right: 4px;
      width: 22px;
      height: 22px;
      border: none;
      border-radius: 50%;
      background: #2b2f3a;
      color: #eee;
      cursor: pointer;
      font-size: .9em;
      line-height: 22px;
      padding: 0;
    }

    .asset-remove:hover {
      background: #c43d3d;
    }

    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(5, 7, 12, 0.75);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 500;
    }

    .modal-backdrop.show {
      display: flex;
    }

    .modal-card {
      background: #0f121d;
      border: 1px solid #1f2433;
      border-radius: 14px;
      width: min(520px, 90vw);
      padding: 22px;
      box-shadow: 0 24px 50px rgba(0, 0, 0, 0.55);
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .modal-card h3 {
      margin: 0;
      color: #f1f5ff;
    }

    .modal-footer {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
    }

    .drop-zone {
      border: 2px dashed #2d3242;
      border-radius: 10px;
      padding: 24px;
      text-align: center;
      color: #aab;
      display: flex;
      flex-direction: column;
      gap: 12px;
      cursor: pointer;
    }

    .drop-zone.dragover {
      border-color: var(--accent);
      background: rgba(45, 50, 66, 0.4);
    }

    .drop-zone strong {
      color: var(--accent2);
    }

    .color-item {
      display: flex;
      align-items: center;
      gap: 8px;
      background: #0f1116;
      border: 1px solid #232734;
      border-radius: 8px;
      padding: 6px 8px;
    }

    .color-swatch {
      width: 30px;
      height: 30px;
      border-radius: 6px;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .font-item {
      display: flex;
      align-items: center;
      gap: 10px;
      background: #0f1116;
      border: 1px solid #232734;
      border-radius: 8px;
      padding: 8px 10px;
    }

    .font-meta {
      color: #bbb;
      font-size: .9em;
    }

    .font-picker {
      margin-top: 16px;
      padding: 14px;
      background: #101217;
      border: 1px solid #232734;
      border-radius: 12px;
    }

    .font-section {
      margin-top: 16px;
      padding: 14px;
      background: #101217;
      border: 1px solid #232734;
      border-radius: 12px;
    }

    .font-section h3 {
      margin: 0 0 12px;
      font-size: 1.1em;
      color: #eee;
    }

    .font-select-group {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-top: 12px;
    }

    .font-select-group label {
      font-size: .9em;
      color: #bbb;
    }

    .font-select-group select {
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid #1f2536;
      background: #0d101b;
      color: #eee;
      width: 100%;
    }

    .font-url-row {
      display: flex;
      align-items: center;
      gap: 8px;
      margin: 6px 0 10px;
    }

    .font-url-row input {
      flex: 1;
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid #1f2536;
      background: #0d101b;
      color: #eee;
    }

    .style-preview {
      margin-bottom: 18px;
      padding: 18px;
      background: #0b0f1a;
      border: 1px solid #232734;
      border-radius: 12px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .style-preview-heading {
      font-family: var(--font-heading);
      font-size: var(--welcome-title-size, 3.4em);
      color: var(--accent2);
      margin: 0;
      text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.45);
    }

    .style-preview-subheading {
      font-family: var(--font-heading);
      font-size: var(--event-title-size, 1.8em);
      color: var(--accent);
      margin: 0;
    }

    .style-preview-body {
      font-family: var(--font-body);
      color: #d4d8eb;
      margin: 0;
    }

    .style-preview-button {
      align-self: flex-start;
      padding: 10px 18px;
      border-radius: 999px;
      border: none;
      background: var(--accent);
      color: #000;
      font-weight: 600;
      font-family: var(--font-heading);
      cursor: pointer;
      transition: transform 0.15s ease, box-shadow 0.2s ease;
    }

    .style-preview-button:hover {
      transform: translateY(-1px);
      box-shadow: 0 10px 22px rgba(0, 0, 0, 0.3);
    }

    .style-grid {
      display: grid;
      gap: 16px;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    }

    .style-control-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 16px;
    }

    .style-control-group label {
      font-size: .9em;
      color: #bbb;
    }

    .style-control-group input,
    .style-control-group select {
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid #1f2536;
      background: #0d101b;
      color: #eee;
    }

    .color-control-group {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 10px;
      margin-top: 18px;
    }

    .color-control-group label {
      font-size: .9em;
      color: #bbb;
    }

    .color-control-group input[type="color"] {
      width: 100%;
      height: 42px;
      border: none;
      border-radius: 8px;
      background: none;
      padding: 0;
      cursor: pointer;
    }

    .color-control-group input[type="color"]::-webkit-color-swatch {
      border-radius: 8px;
      border: 1px solid #1f2536;
    }

    .color-control-group input[type="color"]::-moz-color-swatch {
      border-radius: 8px;
      border: 1px solid #1f2536;
    }

    .color-item.clickable {
      cursor: pointer;
    }

    .dual-font-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 12px;
      margin-bottom: 12px;
    }

    .dual-font-column label {
      display: block;
      font-size: .9em;
      color: #bbb;
      margin-bottom: 4px;
    }

    .font-picker select {
      width: 100%;
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid #1f2536;
      background: #0d101b;
      color: #eee;
    }

    .font-preview-box,
    .font-preview,
    .font-current-previews {
      display: none !important;
    }

    .quick-picks-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: 14px;
      margin-bottom: 6px;
      font-size: .95em;
      color: #bbb;
    }

    .quick-picks-grid {
      display: grid;
      gap: 10px;
      max-height: 220px;
      overflow: hidden;
    }

    .quick-pick-card {
      background: #121522;
      border: 1px solid #1f2536;
      border-radius: 10px;
      padding: 10px 14px;
      color: #eef;
      text-align: left;
      font-size: .95em;
      line-height: 1.4;
      transition: background .2s ease, transform .1s ease;
    }

    .quick-pick-card:hover {
      background: #1b2032;
      transform: translateY(-1px);
    }

    .quick-pick-label {
      font-size: .75em;
      opacity: .7;
      margin-bottom: 4px;
    }

    .quick-pick-fonts {
      font-size: .9em;
    }

    .quick-pick-heading {
      font-weight: 600;
    }

    .quick-pick-preview {
      margin-top: 4px;
      font-size: 1.05em;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .quick-pick-notes {
      margin-top: 4px;
      font-size: .8em;
      opacity: .7;
    }

    button.button-ghost {
      margin: 0;
      padding: 0;
      background: none;
      border: none;
      color: var(--accent);
      font-size: .9em;
      cursor: pointer;
    }

    button.button-ghost:hover {
      text-decoration: underline;
    }

    /* Toast */
    #toast {
      position: absolute;
      right: 12px;
      bottom: 12px;
      background: rgba(16, 18, 23, 0.95);
      color: #fff;
      border: 1px solid #2b2f3a;
      border-radius: 10px;
      padding: 10px 14px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, .35);
      opacity: 0;
      transform: translateY(8px);
      transition: opacity 200ms ease, transform 200ms ease;
      pointer-events: none;
      z-index: 5;
    }

    #toast.show {
      opacity: 1;
      transform: translateY(0);
    }

    #boothScreen {
      display: flex;
      flex-direction: column;
      height: 100vh;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      background-color: #000;
      position: relative;
    }

    #boothHeader {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      background: rgba(0, 0, 0, 0);
    }

    #boothHeader img {
      max-height: 50px;
    }

    #eventTitle {
      font-size: var(--event-title-size, 1.8em);
      flex: 1;
      text-align: center;
      font-family: var(--font);
      color: var(--accent);
    }

    #adminBtn {
      background: none;
      border: none;
      font-size: 1.5em;
      color: white;
      cursor: pointer;
      z-index: 5;
    }

    #boothMain {
      flex: 1;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      position: relative;
      gap: 10px;
    }

    #options,
    #controls {
      width: 18%;
      display: flex;
      flex-direction: column;
      align-items: stretch;
      text-align: center;
      overflow: auto;
      max-height: 88vh;
      padding: 4px;
    }

    #options .thumb {
      width: 100%;
      max-width: 140px;
      margin: 6px 0;
      border: 3px solid transparent;
      border-radius: 10px;
      background: #00000055;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #options .thumb img {
      width: 100%;
      border-radius: 8px;
      display: block;
    }

    #options .thumb img:error {
      visibility: hidden;
    }

    /* Hide broken image icon */
    #options .thumb.selected {
      border-color: var(--accent);
      box-shadow: 0 0 18px #000;
    }

    #zoomControl {
      margin-top: 16px;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.12);
      background: rgba(0, 0, 0, 0.35);
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    #zoomControl .zoom-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.9em;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      color: var(--accent2);
      font-weight: 600;
    }

    #zoomValue {
      font-size: 0.9em;
      color: var(--accent);
    }

    #zoomSlider {
      width: 100%;
      accent-color: var(--accent);
    }

    #zoomHint {
      margin: 0;
      font-size: 0.8em;
      color: #b6c1d2;
    }

    .mode-duration-settings {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 10px;
      margin-top: 10px;
    }

    .mode-duration-settings label {
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 0.85em;
      letter-spacing: 0.03em;
    }

    .mode-duration-settings input[type="number"] {
      width: 100%;
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.14);
      background: rgba(12, 16, 35, 0.9);
      color: inherit;
      font-size: 1em;
    }

    .mode-duration-note {
      font-size: 0.78em;
      color: #9ea9c7;
      margin-top: -4px;
    }

    #videoWrap {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      position: relative;
      gap: 12px;
    }

    .mode-duration-hint {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      padding: 6px 14px;
      border-radius: 999px;
      background: rgba(0, 0, 0, 0.45);
      border: 1px solid rgba(255, 255, 255, 0.18);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--accent2);
      font-size: 0.95em;
    }

    .mode-duration-hint span {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    #videoContainer {
      position: relative;
      border: 6px solid white;
      border-radius: 12px;
      background: black;
      aspect-ratio: var(--capture-aspect, auto);
    }

    #video {
      display: block;
      width: 100%;
      height: 100%;
      border-radius: 6px;
      opacity: 0;
      transition: opacity 500ms ease;
      object-fit: cover;
      transform-origin: center;
      -webkit-transform: scaleX(-1);
      transform: scaleX(-1);
    }

    #lastShot {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 6px;
      pointer-events: none;
      display: none;
      transform-origin: center;
      -webkit-transform: scaleX(1) !important;
      transform: scaleX(1) !important;
    }

    #liveOverlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      border-radius: 6px;
      object-fit: cover;
      -webkit-transform: scaleX(1) !important;
      transform: scaleX(1) !important;
    }

    .view-landscape #videoContainer {
      max-height: 88vh;
      max-width: 80vw;
      aspect-ratio: 16 / 9;
    }

    .view-landscape #video {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .view-portrait #videoContainer {
      height: 88vh;
      aspect-ratio: 9 / 16;
    }

    .view-portrait #video {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    #video.active {
      opacity: 1;
    }

    #captureBtn {
      display: none;
      position: relative;
      z-index: 5;
      align-self: center;
    }

    @media (max-width: 1100px) {
      #boothMain {
        flex-direction: column;
        align-items: center;
      }
      #options,
      #controls {
        width: 100%;
        max-height: none;
        flex-direction: row;
        justify-content: center;
        align-items: center;
        gap: 10px;
        padding: 6px;
      }
      #options {
        order: 3;
        overflow-x: auto;
        overflow-y: hidden;
        -webkit-overflow-scrolling: touch;
      }
      #controls {
        order: 2;
      }
      #options .thumb {
        max-width: 110px;
        margin: 0 6px;
      }
      #videoWrap {
        order: 1;
        width: 100%;
      }
      #videoContainer {
        width: 100%;
        max-width: 680px;
      }
      .view-landscape #videoContainer {
        max-width: min(92vw, 680px);
      }
      #captureBtn {
        margin-bottom: 8px;
      }
    }

    /* shown in photo mode only */
    #captureBtn.primary {
      animation: pulse 1.6s infinite;
      font-family: 'Bangers', cursive;
      font-size: 1.6rem;
      width: 140px;
      height: 140px;
      border-radius: 50%;
      border: 8px solid #deffc1;
      outline: 6px solid #285312;
      background: radial-gradient(120% 120% at 35% 30%, #d0f2d4 0%, #6fd880 40%, #20bc1d 75%, #1a8407 100%);
      color: #000;
      box-shadow: 0 16px 36px rgba(0, 0, 0, .55), inset 0 2px 10px rgba(255, 255, 255, .4);
    }

    #gallery {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      padding: 10px;
      background: rgba(0, 0, 0, 0.6);
    }

    #gallery img {
      max-width: 120px;
      margin: 5px;
      border-radius: 6px;
      border: 2px solid #fff;
    }

    /* Welcome */
    #welcomeScreen {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      z-index: 10;
      transition: opacity 600ms;
      pointer-events: auto;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    }

    #adminScreen:not(.hidden)~#boothScreen #welcomeScreen {
      display: none;
    }

    #welcomeScreen.faded {
      opacity: 0;
      pointer-events: none;
    }

    #welcomeImg {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: -1;
    }

    #welcomeOverlay {
      text-align: center;
      color: white;
      text-shadow: 2px 2px 8px black;
      background: transparent;
      padding: 22px 28px;
      border-radius: 14px;
    }

    #welcomeOverlay h1 {
      font-family: 'Bangers', cursive;
      letter-spacing: 1px;
      font-size: var(--welcome-title-size, 3.4em);
      margin: 0;
      color: var(--accent2);
    }

    #welcomeOverlay p {
      font-size: 1.5 em;
      margin-top: 10px;
      animation: pulse 1.5s infinite;
    }

    /* Start button */
    .start-button {
      position: relative;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: clamp(150px, 22vw, 280px);
      height: clamp(150px, 22vw, 280px);
      padding: 0 28px;
      border-radius: 50%;
      border: 8px solid #fff;
      outline: 6px solid #222;
      background: radial-gradient(120% 120% at 35% 30%, #aae470 0%, #52ca3f 35%, hsl(126, 69%, 38%) 70%, #054704 100%);
      color: #000;
      font-family: 'Bangers', cursive;
      font-size: clamp(1.2rem, 2.6vw, 2.2rem);
      font-weight: 900;
      letter-spacing: .5px;
      text-transform: none;
      cursor: pointer;
      user-select: none;
      box-shadow: 0 16px 40px rgba(0, 0, 0, .55), inset 0 2px 10px rgba(255, 255, 255, .45);
      transition: transform 140ms ease, box-shadow 200ms ease, filter 200ms ease;
      animation: pulse 1.6s infinite;
    }

    .start-button:hover {
      transform: translateY(-1px);
      filter: brightness(1.06);
      box-shadow: 0 20px 44px rgba(0, 0, 0, .6), inset 0 2px 12px rgba(255, 255, 255, .5);
    }

    .start-button:active {
      transform: translateY(0) scale(0.96);
      box-shadow: 0 8px 18px rgba(0, 0, 0, .5), inset 0 2px 10px rgba(0, 0, 0, .25);
    }

    .start-button:focus-visible {
      outline: 3px solid var(--accent2);
      outline-offset: 4px;
    }

    @keyframes pulse {
      0% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.1);
      }

      50% {
        transform: scale(1.06);
        box-shadow: 0 0 15px 8px rgba(0, 0, 0, 0.3);
      }

      100% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.1);
      }
    }

    /* Countdown */
    #countdownOverlay {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: clamp(6rem, 20vw, 18rem);
      font-family: var(--countdown-font, 'Creepster', cursive);
      color: var(--accent);
      text-shadow: 6px 6px 18px #000;
      z-index: 20;
      opacity: 0;
      transform: scale(0.9);
      transition: opacity 250ms, transform 250ms;
      pointer-events: none;
    }

    #countdownOverlay.show {
      opacity: 1;
      transform: scale(1);
    }

    /* Flash overlay */
    #flashOverlay {
      position: absolute;
      inset: 0;
      background: #fff;
      opacity: 0;
      pointer-events: none;
      z-index: 30;
    }

    @keyframes cameraFlash {
      0% {
        opacity: 0;
      }

      10% {
        opacity: 1;
      }

      100% {
        opacity: 0;
      }
    }

    #flashOverlay.flash {
      animation: cameraFlash 350ms ease-out;
    }

    /* Confirm modal */
    #confirmModal {
      position: absolute;
      inset: 0;
      backdrop-filter: blur(2px);
      background: rgba(0, 0, 0, 0.6);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 18;
    }

    #confirmCard {
      background: #111;
      border: 2px solid var(--accent);
      border-radius: 12px;
      padding: 16px;
      width: min(92vw, 820px);
      max-height: 90vh;
      overflow: auto;
    }

    #confirmPreview {
      display: block;
      width: 100%;
      height: auto;
      max-height: 70vh;
      border-radius: 8px;
      object-fit: contain;
    }

    #confirmActions {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      margin-top: 10px;
    }

    /* Final Preview */
    #finalPreview {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, 0.84);
      z-index: 25;
      opacity: 0;
      transition: opacity 400ms;
      pointer-events: none;
    }

    #finalPreviewContent {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      text-align: center;
      flex-wrap: wrap;
      max-width: min(96vw, 1200px);
      margin: 0 auto;
    }

    #finalPreview.show {
      opacity: 1;
      pointer-events: auto;
    }

    #finalStrip {
      max-height: 92vh;
      max-width: 92vw;
      border: 8px solid #fff;
      border-radius: 12px;
      box-shadow: 0 10px 30px #000;
    }

    #finalPreview.qr-ready #finalStrip {
      max-width: min(70vw, 640px);
      max-height: 80vh;
    }

    #finalPreviewActions {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 16px;
      max-width: min(90vw, 320px);
    }

    #qrCodeContainer {
      color: #fff;
      font-family: 'Comic Neue', cursive;
      width: 100%;
      max-width: 320px;
    }

    #qrCodeContainer h2 {
      margin-bottom: 8px;
    }

    #qrCode {
      border: 6px solid white;
      border-radius: 8px;
      max-width: 100%;
      height: auto;
    }

    #emailForm {
      margin-top: 15px;
    }

    #emailForm input {
      padding: 8px;
      border-radius: 5px;
      border: 1px solid #ccc;
      width: 180px;
    }

    #emailShortcuts {
      margin-top: 8px;
    }

    .shortcut-btn {
      font-size: 0.8em;
      padding: 4px 8px;
      margin: 2px;
      background: #333;
    }

    .mode-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 15px 10px !important;
    }

    .mode-btn-icon {
      display: flex;
      gap: 4px;
      align-items: center;
    }

    .mode-btn-icon .photo-rep {
      width: 20px;
      height: 26px;
      background: #fff;
      border: 2px solid #555;
      border-radius: 2px;
    }

    .mode-btn-icon.strip .photo-rep {
      width: 18px;
      height: 14px;
    }

    .mode-btn-icon.strip {
      flex-direction: column;
      gap: 3px;
    }

    .font-picker {
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .font-row {
      display: flex;
      flex-direction: column;
      gap: 6px;
      align-items: flex-start;
    }

    .font-row label {
      font-weight: 600;
      color: var(--accent2);
    }

    .font-row select {
      width: 100%;
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid #232637;
      background: #10131f;
      color: #fff;
    }

    .font-preview {
      width: 100%;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid #232637;
      background: #161a29;
      font-size: 1.2em;
      color: #f6f7ff;
    }

    .font-heading {
      font-family: var(--font-heading);
    }

    .font-body {
      font-family: var(--font-body);
    }

    .font-preview small {
      display: block;
      font-size: 0.75em;
      opacity: 0.7;
      margin-bottom: 4px;
      letter-spacing: 0.3px;
      text-transform: uppercase;
    }

    .font-preview-text {
      display: block;
    }

    .font-quick-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      font-weight: 600;
      color: var(--accent2);
    }

    .font-quick-toggle {
      background: none;
      border: none;
      color: var(--accent);
      font-size: 0.85em;
      padding: 0;
      margin: 0;
      cursor: pointer;
      text-decoration: underline;
    }

    .quick-picks {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 10px;
      max-height: 260px;
      overflow: hidden;
      transition: max-height 0.3s ease;
      position: relative;
      z-index: 0;
    }

    .quick-picks::after {
      content: '';
      position: absolute;
      inset: 0;
      background: #101217;
      border-radius: 12px;
      z-index: -1;
    }

    .quick-picks.expanded {
      max-height: none;
      overflow: visible;
    }

    .quick-pick-card {
      border-radius: 12px;
      border: 1px solid #232637;
      background: #131726;
      color: #f6f7ff;
      padding: 12px;
      text-align: left;
      display: flex;
      flex-direction: column;
      gap: 6px;
      cursor: pointer;
      transition: transform 0.15s ease, box-shadow 0.2s ease;
    }

    .quick-pick-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 28px rgba(0, 0, 0, 0.35);
    }

    .quick-pick-card .quick-pick-label {
      font-size: 0.7em;
      text-transform: uppercase;
      letter-spacing: 0.4px;
      opacity: 0.6;
    }

    .quick-pick-card .quick-pick-title {
      font-weight: 600;
      font-size: 0.95em;
    }

    .quick-pick-card .quick-pick-preview {
      font-size: 1.1em;
      line-height: 1.3;
    }

    .font-divider {
      border: none;
      border-top: 1px solid #232637;
      margin: 10px 0 4px;
    }
  </style>
</head>

<body>
  <div id="adminScreen">
    <h1 class="admin-title">Photobooth Setup</h1>
    <div class="admin-container">
      <div class="admin-left panel">
        <div class="btn-row" style="justify-content:center; margin-top:0;">
          <button id="installBtn" class="primary hidden" type="button">Install App</button>
        </div>
        <details class="panel-section" open>
          <summary>Event Basics</summary>
          <div class="section-content">
            <label for="eventSelect">Choose Event</label>
            <select id="eventSelect"></select>
            <div id="themeQuickSelect" class="theme-quick-grid"></div>
            <label for="eventNameInput">Event Name</label>
            <input type="text" id="eventNameInput" placeholder="e.g., Halloween Dance 2025">
            <div class="btn-row">
              <button type="button" onclick="exportCurrentEvent()">Export Event</button>
            </div>
            <label style="display:inline-flex; align-items:center; gap:8px; margin:0;">
              <input type="checkbox" id="allowRetakes" checked>
              Allow Retakes
            </label>
            <div class="mode-duration-settings">
              <label for="boomerangDuration">
                Boomerang Duration (sec)
                <input type="number" id="boomerangDuration" min="1" max="300" step="1" placeholder="6">
              </label>
              <label for="video360Duration">
                360 Video Duration (sec)
                <input type="number" id="video360Duration" min="1" max="600" step="1" placeholder="12">
              </label>
            </div>
            <p class="mode-duration-note">Displayed to guests so they know how long each capture mode runs.</p>
            <div class="btn-row">
              <button id="startCameraButton" class="primary">Start Camera</button>
              <button id="startBoothButton">Start Booth</button>
              <button type="button" onclick="toggleAnalytics()">Analytics</button>
            </div>
            <div id="analytics" class="hidden">
              <h2>Analytics</h2>
              <pre id="analyticsData"
                style="background:#101217; padding:10px; border-radius:8px; white-space:pre-wrap; word-wrap:break-word;"></pre>
              <div class="btn-row"><button onclick="clearAnalytics()">Clear Analytics</button></div>
            </div>
          </div>
        </details>
        <details class="panel-section">
          <summary>Sharing & Email</summary>
          <div class="section-content">
            <h3 style="margin:0;">Cloudinary (QR Links)</h3>
            <label for="cloudNameInput">Cloud Name</label>
            <input type="text" id="cloudNameInput" placeholder="your_cloud_name">
            <label for="cloudPresetInput">Unsigned Upload Preset</label>
            <input type="text" id="cloudPresetInput" placeholder="photobooth_unsigned">
            <label for="cloudFolderInput">Folder Base (optional)</label>
            <input type="text" id="cloudFolderInput" placeholder="photobooth/events">
            <label style="display:inline-flex; align-items:center; gap:8px; margin:0;">
              <input type="checkbox" id="cloudUseToggle"> Use Cloudinary for share links
            </label>
            <h3 style="margin:0;">Email (EmailJS)</h3>
            <label for="emailJsPublic">Public Key</label>
            <input type="text" id="emailJsPublic" placeholder="public_xxxxx">
            <label for="emailJsService">Service ID</label>
            <input type="text" id="emailJsService" placeholder="service_...">
            <label for="emailJsTemplate">Template ID</label>
            <input type="text" id="emailJsTemplate" placeholder="template_...">
            <div class="btn-row" style="align-items:center; flex-wrap:wrap;">
              <button type="button" onclick="saveCloudinarySettings()">Save Cloudinary Settings</button>
              <button type="button" onclick="saveEmailJsSettings()">Save Email Settings</button>
              <button type="button" onclick="sendTestEmail()">Send Test Email</button>
              <button type="button" id="syncNowBtn" onclick="syncNow()">Sync Now</button>
              <span id="syncStatus" style="color:#aaa; font-size:0.9em;"></span>
            </div>
          </div>
        </details>
        <details class="panel-section">
          <summary>Offline & Device Tools</summary>
          <div class="section-content">
            <div class="admin-field" style="display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin:0;">
              <label style="display:inline-flex; align-items:center; gap:8px; margin:0;">
                <input type="checkbox" id="offlineModeToggle"> Offline Mode (no QR; queue emails)
              </label>
              <button type="button" id="sendPendingBtn" onclick="sendPendingNow()" disabled>Send Pending (0)</button>
              <button type="button" id="cacheAssetsBtn" onclick="makeAvailableOffline()">Make Available Offline</button>
              <label style="display:inline-flex; align-items:center; gap:8px; margin:0;">
                <input type="checkbox" id="forceCameraFileToggle"> Force camera on file://
              </label>
            </div>
            <div class="admin-field" style="margin:0;">
              <label style="display:inline-flex; align-items:center; gap:8px; margin:0;">
                <input type="checkbox" id="useCloudflareUploads"> Use Cloudflare storage for Admin uploads
              </label>
              <small style="display:block; color:#888;">If off and Cloudinary is configured, uploads go to Cloudinary.
                Base64 is no longer used.</small>
            </div>
          </div>
        </details>
        <details class="panel-section" open>
          <summary>Current Assets</summary>
          <div class="section-content">
            <div class="asset-actions">
              <button type="button" id="addBackgroundBtn">Add Background</button>
              <button type="button" id="addOverlaysBtn">Add Overlays</button>
              <button type="button" id="addTemplatesBtn">Add Templates</button>
              <button type="button" id="addLogoBtn">Add Logo</button>
            </div>
            <div id="assetUploadInputs" class="visually-hidden">
              <input type="file" id="themeBackground" accept="image/*">
              <input type="file" id="themeLogo" accept="image/*">
              <input type="file" id="themeOverlays" accept="image/*" multiple>
              <input type="file" id="themeOverlaysFolderPicker" webkitdirectory directory multiple>
              <input type="file" id="themeTemplates" accept="image/*" multiple>
              <input type="file" id="themeTemplatesFolderPicker" webkitdirectory directory multiple>
            </div>
            <div id="currentAssets" class="current-assets">
              <div
                style="display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:10px;">
                <span style="font-weight:600; color:var(--accent2);">Selections</span>
                <span id="undoBar" style="display:inline-flex; align-items:center; gap:8px; font-size:.9em;">
                  <button id="undoBtn" onclick="undoLastRemoval()" disabled>Undo last remove</button>
                  <span id="undoCount" style="color:#aaa;"></span>
                </span>
              </div>
              <div class="asset-row">
                <label>Backgrounds:</label>
                <div id="currentBackgrounds" class="asset-grid"></div>
              </div>
              <div class="asset-row">
                <label>Logo:</label>
                <div id="currentLogo" class="asset-single"></div>
              </div>
              <div class="asset-row">
                <label>Font:</label>
                <div id="currentFont" class="asset-single"></div>
              </div>
              <div class="asset-row">
                <label>Accent Colors:</label>
                <div id="currentAccents" class="asset-grid"></div>
              </div>
              <div class="asset-row">
                <label>Overlays:</label>
                <div id="currentOverlays" class="asset-grid"></div>
              </div>
              <div class="asset-row">
                <label>Templates:</label>
                <div id="currentTemplates" class="asset-grid"></div>
              </div>
            </div>
          </div>
        </details>
        <details class="panel-section" open>
          <summary>Theme Styling</summary>
          <div class="section-content">
            <div id="stylePreview" class="style-preview">
              <h3 id="stylePreviewHeading" class="style-preview-heading">Welcome to the photobooth!</h3>
              <p id="stylePreviewSubheading" class="style-preview-subheading">Event Title Sample</p>
              <p id="stylePreviewBody" class="style-preview-body">Make every capture unforgettable.</p>
              <button type="button" id="stylePreviewButton" class="style-preview-button">Touch to start</button>
            </div>
            <div class="style-grid">
              <div class="font-section fonts-main">
                <div class="quick-picks-header">
                  <span>Quick Picks</span>
                  <button type="button" id="qpToggle" class="button-ghost">show all</button>
                </div>
                <div id="quickPicks" class="quick-picks-grid"></div>
                <div class="style-control-group">
                  <label for="themeWelcomeTitle">Welcome Heading</label>
                  <input type="text" id="themeWelcomeTitle" placeholder="Welcome to the photobooth!">
                  <label for="themeWelcomePrompt">Start Button Text</label>
                  <input type="text" id="themeWelcomePrompt" placeholder="Touch to start">
                  <label for="welcomeTitleSizeInput">Welcome Heading Size (em)</label>
                  <input type="number" id="welcomeTitleSizeInput" min="0.5" max="6" step="0.1" placeholder="3.4">
                  <label for="eventTitleSizeInput">Live Preview Heading Size (em)</label>
                  <input type="number" id="eventTitleSizeInput" min="0.5" max="5" step="0.1" placeholder="1.8">
                </div>
                <div class="font-select-group">
                  <label for="headingFontSelect">Heading Font</label>
                  <select id="headingFontSelect"></select>
                </div>
                <div class="font-select-group">
                  <label for="bodyFontSelect">Body Font</label>
                  <select id="bodyFontSelect"></select>
                </div>
                <div class="font-select-group">
                  <label for="fontPairingSelect">Pairing Suggestions</label>
                  <select id="fontPairingSelect"></select>
                </div>
                <div class="color-control-group">
                  <label for="themeAccent">Primary Accent</label>
                  <input type="color" id="themeAccent" value="#3f51b5">
                  <label for="themeAccent2">Secondary Accent</label>
                  <input type="color" id="themeAccent2" value="#ffffff">
                </div>
              </div>
              <div class="font-section fonts-add">
                <h3>Add Fonts</h3>
                <label for="addFontUrl">Google Fonts URL</label>
                <div class="font-url-row">
                  <input type="text" id="addFontUrl" placeholder="https://fonts.googleapis.com/css2?family=...&amp;display=swap">
                  <button type="button" onclick="addFontByUrl()">Add URL</button>
                </div>
                <small>Paste the full Google Fonts URL (including weights). Fonts load instantly for this device.</small>
                <label for="addFontFamily" style="margin-top:12px; display:block;">Google Font Family (optional)</label>
                <div class="font-url-row">
                  <input type="text" id="addFontFamily" placeholder="e.g., Pacifico">
                  <button type="button" onclick="addFontByFamily()">Add Family</button>
                </div>
                <div id="currentFonts" style="margin-top:8px; font-size:0.95em; color:#bbb;">Loading fonts listâ€¦</div>
                <div class="quick-picks-add" style="margin-top:16px;">
                  <h4>Create a pairing</h4>
                  <form id="quickPickForm" class="quick-picks-form">
                    <input id="addPairingHeading" list="fontSuggestions" type="text" placeholder="Heading font (e.g., Playfair Display)">
                    <input id="addPairingBody" list="fontSuggestions" type="text" placeholder="Body font (e.g., Source Sans 3)">
                    <input id="addPairingPreview" type="text" placeholder="Preview text (optional)">
                    <input id="addPairingNotes" type="text" placeholder="Notes (optional)">
                    <button type="submit" id="addPairingBtn">Add Pairing</button>
                  </form>
                  <small id="customPairingHint" class="quick-picks-hint">Fonts must be available on Google Fonts or added above.</small>
                  <div id="customPairingsList" class="custom-pairings-list"></div>
                </div>
                <datalist id="fontSuggestions"></datalist>
              </div>
            </div>
          </div>
        </details>
      </div>
      <div id="toast" role="status" aria-live="polite"></div>
      <div class="admin-right panel">
        <div id="themeEditor">
          <h2>Theme Editor</h2>
          <p style="color:#bbb; margin-top:0;">Theme assets are managed from the controls on the left. A single shared
            logo now applies to every theme.</p>
          <details class="theme-tools" style="margin-top:12px;">
            <summary style="cursor:pointer; color:#ddd;">Theme data tools</summary>
            <div class="btn-row" style="margin-top:10px;">
              <button onclick="exportThemes()">Export Themes</button>
              <button onclick="importThemes()">Import Themes</button>
              <button onclick="exportSetupPackage()">Export Package (zip)</button>
              <button onclick="triggerImportZip()">Import Package (zip)</button>
            </div>
            <div class="icon-tiles">
              <button class="icon-tile" onclick="rebuildManifestsUI()" aria-label="Rebuild Manifests">
                <span class="icon-glyph" aria-hidden="true">ðŸ”„</span>
                <span class="icon-label">Rebuild</span>
              </button>
            </div>
          </details>
          <input type="file" id="importFile" class="hidden" accept=".json" onchange="handleImport()">
          <input type="file" id="importZip" class="hidden" accept=".zip" onchange="handleImportZip()">
        </div>

        <details class="admin-help">
          <summary>Help &amp; How-To</summary>
          <div class="admin-help-content">
            <section class="help-block">
              <h3>Deploy</h3>
              <small>Option A (Git projects): create a Cloudflare Pages Deploy Hook and paste it here. Clicking Deploy
                Now will trigger a new build.</small>
              <label for="deployHookUrl" class="help-field">
                Deploy Hook URL
                <input type="text" id="deployHookUrl"
                  placeholder="https://api.cloudflare.com/client/v4/pages/webhooks/deploy_hooks/...">
              </label>
              <div class="icon-tiles" style="margin-top:6px;">
                <button class="icon-tile" onclick="triggerDeployHook()" aria-label="Deploy Now">
                  <span class="icon-glyph" aria-hidden="true">ðŸš€</span>
                  <span class="icon-label">Deploy</span>
                </button>
                <button class="icon-tile" onclick="saveDeploySettings()" aria-label="Save Deploy Hook"
                  title="Save Deploy Hook">
                  <span class="icon-glyph" aria-hidden="true">ðŸ’¾</span>
                  <span class="icon-label">Save</span>
                </button>
              </div>
            </section>
            <details class="help-block">
              <summary>How to enable one-click deploy (Git)</summary>
              <ol>
                <li>Cloudflare â†’ Pages â†’ your Git project â†’ Settings â†’ Build &amp; deploy.</li>
                <li>Framework preset: None.</li>
                <li>Build command: <code id="buildCmdText">npm ci &amp;&amp; node tools/update-manifests.js &amp;&amp; echo skip</code> <button
                    type="button" onclick="copyBuildCmd()">Copy</button></li>
                <li>Build output directory: <code>.</code></li>
                <li>Settings â†’ Deploy Hooks â†’ Create hook â†’ copy URL and paste above â†’ Save.</li>
                <li>Click â€œDeploy Nowâ€ anytime to rebuild + publish.</li>
              </ol>
            </details>
            <details class="help-block">
              <summary>Direct upload (no Git)</summary>
              <div>
                <p>Run this one command from the project folder:</p>
                <p><code id="shipCmdText">npm run ship</code> <button type="button" onclick="copyShipCmd()">Copy</button></p>
                <p>It rebuilds manifests and deploys to your Pages project.</p>
                <p>Prefer a desktop button? In Finder, rightâ€‘click <code>Ship.command</code> â†’ Open. First time run: <code>chmod +x Ship.command</code>. Drag it to the Dock or make an alias.</p>
              </div>
            </details>
            <details class="help-block">
              <summary>QR / Email (Cloudinary)</summary>
              <p>Enter Cloudinary Cloud Name + Unsigned Upload Preset in Admin â†’ Email/Cloudinary, check â€œUse Cloudinary for share linksâ€, then Save. QR will always point to a public URL.</p>
            </details>
            <details class="help-block">
              <summary>After deploy</summary>
              <p>Hard refresh the app (DevTools â†’ Application â†’ Service Workers â†’ Unregister â†’ reload). If you added files, click â€œMake Available Offlineâ€ to recache.</p>
            </details>
          </div>
        </details>
    </div>
  </div>

  <div id="boothScreen" class="hidden">
    <div id="boothHeader">
      <img id="logo" />
      <h1 id="eventTitle">ðŸŽƒ Happy Halloween!</h1>
      <button id="adminBtn" onclick="goAdmin()">âš™ï¸</button>
    </div>
    <div id="boothMain">
      <div id="options"></div>
      <div id="videoWrap" class="view-landscape">
        <div id="videoContainer"><video id="video" class="hidden" autoplay playsinline muted></video><img
            id="lastShot" /><img id="liveOverlay" /></div>
        <button id="captureBtn" class="primary" onclick="capturePhotoFlow()">Take Photo</button>
        <div id="modeDurationHint" class="mode-duration-hint hidden" aria-live="polite"></div>
      </div>
      <div id="controls">
        <button class="mode-btn" onclick="setMode('photo')">
          <div class="mode-btn-icon">
            <div class="photo-rep"></div>
          </div>
          <span>Single Photo</span>
        </button>
        <button class="mode-btn" onclick="setMode('strip')">
          <div class="mode-btn-icon strip">
            <div class="photo-rep"></div>
            <div class="photo-rep"></div>
            <div class="photo-rep"></div>
          </div>
          <span>Photo Strip</span>
        </button>
        <div id="zoomControl" class="hidden">
          <div class="zoom-header">
            <span>Zoom</span>
            <span id="zoomValue">1.0x</span>
          </div>
          <input type="range" id="zoomSlider" min="1" max="2" step="0.01" value="1" disabled>
          <p id="zoomHint">Adjust framing without moving the booth.</p>
        </div>
      </div>
    </div>
    <div id="countdownOverlay"></div>
    <div id="flashOverlay"></div>
    <div id="finalPreview">
      <div id="finalPreviewContent">
        <img id="finalStrip" />
        <div id="finalPreviewActions">
          <div id="qrCodeContainer" class="hidden">
            <h2 style="display:flex; align-items:center; gap:10px;">Scan to Download <span id="shareStatus"
                style="display:none; font-size:0.8em; padding:4px 8px; border-radius:999px; background: var(--accent); color:#000;">Preparing
                linkâ€¦</span></h2>
            <canvas id="qrCode"></canvas>
            <div id="qrHint" style="display:none; font-size:0.9em; color:#ccc; margin-top:6px;"></div>
            <div id="shareLinkRow" style="margin-top:8px; display:none; align-items:center; gap:8px; flex-wrap:wrap;">
              <a id="shareLink" href="#" target="_blank" rel="noopener"
                style="color: var(--accent2); word-break: break-all;"></a>
              <button type="button" onclick="openShareLink()">Open</button>
              <button type="button" onclick="copyShareLink()">Copy</button>
              <button type="button" onclick="downloadShareImage()">Download</button>
            </div>
            <form id="emailForm" onsubmit="sendEmail(event)">
              <input type="email" id="emailInput" placeholder="your@email.com" required onfocus="cancelHideTimer()"
                onblur="startHideTimerIfIdle()" />
              <button type="submit" id="sendBtn" onclick="cancelHideTimer()">Send</button>
              <div id="emailShortcuts">
                <button type="button" class="shortcut-btn" onclick="appendEmailText('@gmail.com')">@gmail.com</button>
                <button type="button" class="shortcut-btn"
                  onclick="appendEmailText('@outlook.com')">@outlook.com</button>
                <button type="button" class="shortcut-btn"
                  onclick="appendEmailText('@hotmail.com')">@hotmail.com</button>
                <button type="button" class="shortcut-btn" onclick="appendEmailText('.com')">.com</button>
              </div>
            </form>
          </div>
          <button id="closePreviewBtn" onclick="exitFinalPreview()">âœ… Done</button>
          <button id="retakeBtn" onclick="retakePhoto()">ðŸ”„ Retake</button>
        </div>
      </div>
    </div>
    <div id="confirmModal">
      <div id="confirmCard">
        <img id="confirmPreview" />
        <div id="confirmActions">
          <button onclick="closeConfirm()">Back</button>
          <button class="primary" onclick="confirmTemplate()">Yes, Use This</button>
        </div>
      </div>
    </div>
    <div id="gallery"></div>
    <div id="welcomeScreen">
      <img id="welcomeImg" />
      <div id="welcomeOverlay">
        <h1 id="welcomeTitle">ðŸŽƒ Happy Halloween!</h1>
        <button id="startButton" type="button" class="start-button">Touch to start</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>

  <div id="createThemeModal" class="modal-backdrop">
    <div class="modal-card">
      <h3>Create New Theme</h3>
      <label for="createThemeName">Theme Name</label>
      <input type="text" id="createThemeName" placeholder="My New Theme">
      <div id="createThemeSummary" style="color:#aab; font-size:0.9em;"></div>
      <div id="createThemeDropZone" class="drop-zone">
        <strong>Drop your theme folder here</strong>
        <span>Include folders like <code>backgrounds/</code>, <code>overlays/</code>, <code>templates/</code>.</span>
        <button type="button" id="createThemeBrowseBtn">Browseâ€¦</button>
      </div>
      <div class="modal-footer">
        <button type="button" id="createThemeCancel">Cancel</button>
        <button type="button" id="createThemeConfirm" class="primary">Create Theme</button>
      </div>
    </div>
  </div>
  <input type="file" id="createThemeFolderInput" class="hidden" webkitdirectory multiple>

  <script type="module" src="scripts/app.js"></script>
</body>

</html>
